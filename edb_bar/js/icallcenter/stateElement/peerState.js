hojo.provide("icallcenter.stateElement.peerState");hojo.declare("icallcenter.stateElement.peerState",null,{_callStateValue:[],constructor:function(a){this._base=a;if(this._states==""){var b=this;hojo.forEach(b._base._phone.PhonebarConfig.split(","),function(c){b._put(c.split(":")[0],c.split(":")[1])})};this._callStateValue["0"]="stInvalid";this._callStateValue["1"]="stBusy";this._callStateValue["2"]="stRest";this._callStateValue["99"]="stSystemBusy"},_base:null,_curPeerStateKey:"0",_states: new Array(),_changeToolBarState:function(d){hojo.publish("EvtPeerToolBarChange",[d._curPeerStateKey])},_setPeerState:function(f){this._curPeerStateKey=f},_put:function(g,h){this._states.push({key:g,value:h})},_get:function(g){try{for(i=0;i<this._states.length;i++){if(this._states[i].key==g){return this._states[i]}}}catch(e){return null}},_switchPeerState:function(j){if(j.Event=="UserStatus"){if(this._base._phone.userId==j.UserID){this._base._curPeerState=this._base._getPeerState();this._base._curPeerState._setPeerState(j.BusyType);if(this._base._curCallState!=null){if(this._base._curCallState._callState=="stInvalid"){this._changeToolBarState(this._base._curPeerState)}}}}else {if(j.Event=="UserBusy"){if(this._base._phone.userId==j.UserID){this._base._curPeerState=this._base._getPeerState();this._base._curPeerState._setPeerState(j.BusyType);if(this._base._curCallState!=null){if(this._base._curCallState._callState=="stInvalid"){this._changeToolBarState(this._base._curPeerState)}}}}else {if(j.Event=="IvrMenuEnd"){hojo.publish("ivrMenuTransfering",[j])}else {if(j.Event=="TransferSuccess"||j.Event=="TransferFailed"){j.Type="Transfer";if(j.Investigate){j.Type="Investigate"};hojo.publish("transfering",[j])}}}}},_publish:function(){alert("\u5f00\u59cb\u629b\u4e8b\u4ef6busy")}})